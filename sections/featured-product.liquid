{%- comment -%}
***************************************************************
PLEASE NOTE: Do not change this file! 
This theme is managed by the Replica app. 
Any manual changes may be automatically overwritten at any time.
3rd PARTY APP DEVELOPERS BEWARE WITH INSTALLS!
Modify at your own peril, a broken website is the likely result.
***************************************************************
{%- endcomment -%}

{%- assign product = all_products[section.settings.featured_product] -%}
{%- assign variant = product.selected_or_first_available_variant -%}

{%- if product == empty -%}
  {%- assign section_onboarding = true -%}
  {%- assign vendor = 'homepage.onboarding.product_vendor' | t -%}
  {%- assign title = 'homepage.onboarding.product_title' | t -%}
  {%- assign compare_at_price = 2999 -%}
  {%- assign price = 1999 -%}
{%- else -%}
  {%- assign section_onboarding = false -%}
  {%- assign vendor = product.vendor -%}
  {%- assign title = product.title -%}
  {%- assign compare_at_price = variant.compare_at_price -%}
  {%- assign price = variant.price -%}
{%- endif -%}

{% if section.settings.product_quantity_enable == false %}
  <style>
    .selector-wrapper select, .product-variants select {
      margin-bottom: 13px;
    }
  </style>
{% endif %}

<style>
  /* Featured Product Specific Quantity Selector Styles */
  #ProductSection-{{ section.id }} .js-qty {
    width: 100%;
    border: 1px solid #E9E9E9;
    border-radius: 2px;
    background: white;
    position: relative;
    overflow: visible;
    height: 50px; /* Match select height */
  }
  
  #ProductSection-{{ section.id }} .js-qty .js--num {
    display: block;
    background: none;
    text-align: center;
    width: 100%;
    padding: 8px 30px;
    margin: 0;
    border: none;
    font-size: 14px;
    color: #333;
    border-radius: 2px;
    height: 100%;
    box-sizing: border-box;
  }
  
  #ProductSection-{{ section.id }} .js-qty .js--qty-adjuster {
    cursor: pointer;
    position: absolute;
    display: block;
    top: 0;
    bottom: 0;
    padding: 8px 0;
    width: 30px;
    text-align: center;
    overflow: hidden;
    user-select: none;
    transition: all 0.2s ease-out;
    font-size: 16px;
    font-weight: bold;
    color: #666;
    background: transparent;
    border: none;
    height: 100%;
    box-sizing: border-box;
  }
  
  #ProductSection-{{ section.id }} .js-qty .js--qty-adjuster:hover {
    background-color: #f5f5f5;
    color: #333;
  }
  
  #ProductSection-{{ section.id }} .js-qty .js--qty-adjuster:active {
    background-color: #e0e0e0;
  }
  
  #ProductSection-{{ section.id }} .js-qty .js--add {
    right: 0;
    border-left: 1px solid #E9E9E9;
    border-top-right-radius: 2px;
    border-bottom-right-radius: 2px;
  }
  
  #ProductSection-{{ section.id }} .js-qty .js--minus {
    left: 0;
    border-right: 1px solid #E9E9E9;
    border-top-left-radius: 2px;
    border-bottom-left-radius: 2px;
  }
  
  #ProductSection-{{ section.id }} .js-qty .js--num:focus {
    outline: none;
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
  }
  
  /* Featured Product Specific Select Elements */
  #ProductSection-{{ section.id }} .selector-wrapper select,
  #ProductSection-{{ section.id }} .product-variants select {
    height: 50px;
    box-sizing: border-box;
  }
  
  /* Featured Product Specific AddToCartForm select */
  #ProductSection-{{ section.id }} .addToCartForm select {
    min-height: 50px;
  }
  
  /* Featured Product Specific quantity input */
  #ProductSection-{{ section.id }} input#quantity {
    width: 100% !important;
  }
  
  /* Featured Product Specific spacing */
  #ProductSection-{{ section.id }} .js-qty {
    margin-bottom: 20px;
  }
  
</style>

<script>
  $(document).ready(function() {
    // Setup quantity selector functionality for featured product
    $('#ProductSection-{{ section.id }} .js--qty-adjuster').on('click', function() {
      var el = $(this);
      var qtySelector = el.siblings('.js--num');
      var qty = parseInt(qtySelector.val()) || 1;
      var qtyMin = 1;
      
      // Add or subtract from the current quantity
      if (el.hasClass('js--add')) {
        qty = qty + 1;
      } else {
        qty = qty <= qtyMin ? qtyMin : qty - 1;
      }
      
      // Update the input's number
      qtySelector.val(qty);
      
      // Trigger change event for form submission
      qtySelector.trigger('change');
    });
    
    // Ensure quantity is always at least 1 for featured product
    $('#ProductSection-{{ section.id }} .js--num').on('blur', function() {
      var qty = parseInt($(this).val()) || 1;
      if (qty < 1) {
        $(this).val(1);
      }
    });
    
    // Featured Product Clickable Box Selector Functionality
    $('#ProductSection-{{ section.id }} .variant-selector-boxes .variant-box').on('click', function() {
      var $box = $(this);
      var variantId = $box.data('variant-id');
      var $select = $box.closest('.variant-selector-boxes').find('select');
      
      // Don't allow selection of sold out variants
      if ($box.hasClass('sold-out')) {
        return;
      }
      
      // Update selected state
      $box.siblings('.variant-box').removeClass('selected');
      $box.addClass('selected');
      
      // Update hidden select
      $select.val(variantId).trigger('change');
      
      // Update SKU and UPC display if they exist
      var sku = $box.data('sku');
      var barcode = $box.data('barcode');
      
      if (sku) {
        $('#ProductSection-{{ section.id }} .variant-sku').text(sku);
      }
      if (barcode) {
        $('#ProductSection-{{ section.id }} .variant-barcode').text(barcode);
      }
    });
  });
</script>

<div id="ProductSection-{{ section.id }}" data-section-id="{{ section.id }}" data-section-type="product-template" data-related-enabled="{{ section.settings.product_related_enable }}" data-social-sharing="{{ section.settings.social_sharing }}" data-show-compare-at-price="false" data-stock="false" data-incoming-transfer="false" data-ajax-cart-method="{{ settings.ajax_cart_method }}">

  {% if section.settings.title != blank %}
    <div class="section-header">
      <h2 class="section-header--left h2">{{ section.settings.title | escape }}</h2>
    </div>
  {% endif %}

{% include 'breadcrumb' %}

<hr>

<div class="grid" itemscope itemtype="http://schema.org/Product">
  <meta itemprop="url" content="{{ shop.url }}{{ product.url }}">
  <meta itemprop="image" content="{{ product.featured_image.src | img_url: 'grande' }}">

  <div class="grid-item large--two-fifths">
    <div class="grid">
      <div class="grid-item large--eleven-twelfths text-center">
        <div class="product-photo-container" id="productPhotoContainer-{{ section.id }}">
          {% unless section_onboarding %}
            {% assign featured_image = product.selected_or_first_available_variant.featured_image | default: product.featured_image %}
            {% for image in product.images %}
              {%- capture img_wrapper_id -%}productPhotoWrapper-{{ section.id }}-{{ image.id }}{%- endcapture -%}
              {%- assign max_width = 690 -%}
              {%- assign max_height = 1000 -%}

              {%- include 'image-logic' with width: max_width, height: max_height -%}

              {%- assign img_url = image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
              <div id="{{ img_wrapper_id }}" class="lazyload__image-wrapper{% unless image == featured_image %} hide{% endunless %}" data-image-id="{{ image.id }}" style="max-width: {{ max_width }}px">
                <div class="no-js product__image-wrapper" style="padding-top:{{ 1 | divided_by: image.aspect_ratio | times: 100}}%;">
                    <img id="{{ img_id }}"
                      {% if forloop.first == true %}
                      src="{{ featured_image | img_url: '300x300' }}"
                      {% endif %}
                      class="lazyload no-js lazypreload"
                      data-src="{{ img_url }}"
                      data-widths="[180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048]"
                      data-aspectratio="{{ image.aspect_ratio }}"
                      data-sizes="auto"
                      alt="{{ image.alt | escape }}"
>
                </div>
              </div>
              {% if forloop.first == true %}
                <noscript>
                  <img src="{{ image | img_url: '580x' }}"
                    srcset="{{ image | img_url: '580x' }} 1x, {{ image | img_url: '580x', scale: 2 }} 2x"
                    alt="{{ image.alt }}" style="opacity:1;">
                </noscript>
              {% endif %}
          {% endfor %}
          {% else %}
            {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
          {% endunless %}
        </div>
      </div>
    </div>
  </div>

  <div class="grid-item large--three-fifths">

    <h1 class="h2" itemprop="name">{{ title }}</h1>

    {% unless vendor == 'Hardware-Catalyst' or vendor == "Do It Best" or vendor == shop.name or vendor == "True Value Rental" %} 
      <p class="product-meta" itemprop="brand">{{ vendor }}</p>
    {% endunless %}

    <div class="item-codes">
      {%- assign current_variant = product.selected_or_first_available_variant -%}
      {%- comment -%} SKU Logic {%- endcomment -%}
      {% if current_variant.sku != blank %}
        {% if settings.display_logged_in_customer_skus %}
          {% if customer %}
            <span>SKU: </span><span class="variant-sku">{{ current_variant.sku }}</span>
          {% endif %}
        {% else %}
          {% if section.settings.product_sku_enable %}
            <span>SKU: </span><span class="variant-sku">{{ current_variant.sku }}</span>
          {% endif %}
        {% endif %}
      {% endif %}
      {%- comment -%} UPC Logic {%- endcomment -%}
      {% if settings.display_logged_in_customer_upcs %}
        {% if customer %}
          {% if current_variant.barcode != blank %}
            <span>UPC: </span><span class="variant-barcode">{{ current_variant.barcode }}</span>
          {% endif %}
        {% endif %}
      {% else %}
        {% if section.settings.product_upc_enable %}
          {% if current_variant.barcode != blank %}
            <span>UPC: </span><span class="variant-barcode">{{ current_variant.barcode }}</span>
          {% endif %}
        {% endif %}
      {% endif %}
    </div>

    <!-- Move Available variant quantity messaging to the top -->
    {% assign curr_variant = product.selected_or_first_available_variant %}
    {% assign qty = curr_variant.inventory_quantity %}

    <div id="variantQuantity-{{ section.id }}" class="variant-quantity">
      {% if section.settings.product_quantity_message and section.settings.house_hasson_catalog == false %}
        {% include 'svg-definitions' with 'stock-icon' %}
        <span id="variantQuantity-{{ section.id }}__message">
        Available Inventory: {{ qty }}
        </span>
      {% endif %}
      
      {% if section.settings.product_quantity_message and section.settings.house_hasson_catalog %}
        {% include 'svg-definitions' with 'stock-icon' %} 
        <span id="variantQuantity-{{ section.id }}__message">
        Available Inventory: 
          {% if qty == 0 %}
            Out of Stock
          {% elsif qty >= 10 and qty < 20 %}
            Low Stock
          {% elsif qty >= 20 %}
            In Stock
          {% else %}
            {{ qty }}
          {% endif %}
        </span>
      {% endif %}
    </div>
    <!-- end -->

    <div itemprop="offers" itemscope itemtype="http://schema.org/Offer">

      {% assign variant = product.selected_or_first_available_variant %}

      {% unless settings.hide_price or section.settings.hide_price %}
      <meta itemprop="priceCurrency" content="{{ cart.currency.iso_code }}">
      <meta itemprop="price" content="{{ price | divided_by: 100.00 }}">
      
      <ul class="inline-list product-meta" data-price>
        <li>
          <span id="productPrice-{{ section.id }}" class="h1">
            {% include 'price' with price %}
          </span>
          {% include 'product-unit-price' variant: variant %}
        </li>
        {% if compare_at_price > price and section.settings.product_savings %}
        <li>
          <span id="comparePrice-{{ section.id }}" class="sale-tag large">
            {% assign compare_price = compare_at_price %}
            {% assign product_price = price %}
            {% include 'price-sale' %}
          </span>
        </li>
        {% endif %}
      </ul>

      {%- if shop.taxes_included or shop.shipping_policy.body != blank -%}
        <div class="product__policies rte">
          {%- if shop.taxes_included -%}
            {{ 'products.general.include_taxes' | t }}
          {%- endif -%}
          {%- if shop.shipping_policy.body != blank -%}
            {{ 'products.general.shipping_policy_html' | t: link: shop.shipping_policy.url }}
          {%- endif -%}
        </div>
      {%- endif -%}
      {% endunless %}

      <hr id="variantBreak" class="hr--clear hr--small">

      <link itemprop="availability" href="http://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}">

      {% if section_onboarding %}
        <div class="add-to-cart">
          <button type="submit" name="add" id="addToCart-{{ section.id }}" class="btn btn--add-to-cart" disabled="disabled">
            <span class="icon icon-cart"></span>
            <span id="addToCartText-{{ section.id }}">
              {{ 'products.product.sold_out' | t }}
            </span>
          </button>
        </div>
      {% else %}
        {% capture "form_class" -%}
          addToCartForm{% if section.settings.enable_payment_button %} addToCartForm--payment-button{% endif %}
        {%- endcapture %}

      {%- capture "form_id" -%}addToCartForm-{{ section.id }}{%- endcapture -%}

      {% form 'product', product, data-productid: product.id, class:form_class, id:form_id, data-product-form: '' %}
          {% unless section.settings.hide_variant_selector %}
          {% if section.settings.enable_clickable_boxes %}
            {% assign has_only_default_title = false %}
            {% if product.variants.size == 1 and product.variants.first.title == "Default Title" %}
              {% assign has_only_default_title = true %}
            {% endif %}
            
            {% unless has_only_default_title %}
              <!-- Hide selector wrappers when using box selectors -->
              <style>
                .selector-wrapper { display: none !important; }
              </style>
              <!-- Box Selector -->
              <div class="variant-selector-boxes" data-product-id="{{ product.id }}" data-section-id="{{ section.id }}">
                {% for variant in product.variants %}
                  {% assign media_id = '' %}
                  {% for media in product.media %}
                    {% if media.id == variant.featured_media.id %}
                      {% assign media_id = media.id %}
                      {% break %}
                    {% endif %}
                  {% endfor %}
                  <div class="variant-box {% if variant == product.selected_or_first_available_variant %}selected{% endif %} {% unless variant.available %}sold-out{% endunless %}" 
                       data-variant-id="{{ variant.id }}" 
                       data-sku="{{ variant.sku }}" 
                       data-barcode="{{ variant.barcode }}"
                       data-featured-media-id="{{ media_id }}"
                       data-available="{{ variant.available }}">
                    <span class="variant-box-text">{{ variant.title }}</span>
                  </div>
                {% endfor %}
                <!-- Hidden select for form submission -->
                <select name="id" data-productid="{{ product.id }}" id="productSelect-{{ section.id }}" class="product-variant-selector product-variants-{{ section.id }}" style="display: none;">
                  {% for variant in product.variants %}
                    {% if variant.available %}
                      <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} data-sku="{{ variant.sku }}" value="{{ variant.id }}">{{ variant.title }}</option>
                    {% else %}
                      <option disabled="disabled">
                        {{ variant.title }} - {{ 'products.product.sold_out' | t }}
                      </option>
                    {% endif %}
                  {% endfor %}
                </select>
              </div>
            {% else %}
              <!-- Hidden select for form submission when only Default Title variant exists -->
              <select name="id" data-productid="{{ product.id }}" id="productSelect-{{ section.id }}" class="product-variant-selector product-variants-{{ section.id }}" style="display: none;">
                {% for variant in product.variants %}
                  {% if variant.available %}
                    <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} data-sku="{{ variant.sku }}" value="{{ variant.id }}">{{ variant.title }}</option>
                  {% else %}
                    <option disabled="disabled">
                      {{ variant.title }} - {{ 'products.product.sold_out' | t }}
                    </option>
                  {% endif %}
                {% endfor %}
              </select>
            {% endunless %}
          {% else %}
            <!-- Dropdown Selector (Default) -->
            <select name="id" data-productid="{{ product.id }}" id="productSelect-{{ section.id }}" class="product-variants product-variants-{{ section.id }}">
              {% for variant in product.variants %}
                {% if variant.available %}
                  <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} data-sku="{{ variant.sku }}" value="{{ variant.id }}">{{ variant.title }} - {{ price | money_with_currency }}</option>
                {% else %}
                  <option disabled="disabled">
                    {{ variant.title }} - {{ 'products.product.sold_out' | t }}
                  </option>
                {% endif %}
              {% endfor %}
            </select>
          {% endif %}
          {% endunless %}

          {% if section.settings.product_quantity_enable %}
            <label for="quantity" class="quantity-selector quantity-selector-{{ section.id }}">{{ 'products.product.quantity' | t }}</label>
            <div class="js-qty">
              <input type="text" class="js--num" value="1" min="1" data-id="quantity" aria-label="quantity" pattern="[0-9]*" name="quantity" id="quantity">
              <span class="js--qty-adjuster js--add" data-id="quantity" data-qty="1">+</span>
              <span class="js--qty-adjuster js--minus" data-id="quantity" data-qty="-1">-</span>
            </div>
          {% endif %}

          <div class="payment-buttons">
            <button style="{% if section.settings.hide_add_to_cart %}display:none;{% endif %}" type="submit" name="add" id="addToCart-{{ section.id }}" class="btn btn--add-to-cart{% if section.settings.enable_payment_button %} btn--secondary-accent{% endif %}"{% unless variant.available %} disabled="disabled"{% endunless %}>
              <span class="icon icon-cart"></span>
              <span id="addToCartText-{{ section.id }}">
                {% if variant.available %}
                  {{ 'products.product.add_to_cart' | t }}
                {% else %}
                  {{ 'products.product.sold_out' | t }}
                {% endif %}
              </span>
            </button>

            {% if section.settings.enable_payment_button %}
              {{ form | payment_button }}
            {% endif %}
          </div>
        {% endform %}

        <a class="full-details text-link"{% unless section_onboarding %} href="{{ product.url }}?variant={{ variant.id }}"{% endunless %}>
          <h5>{{ 'products.product.full_details' | t }} &#x2192;</h5>
        </a>
      {% endif %}
    </div>

    {% if section.settings.social_sharing_products %}
      {% include 'social-sharing' %}
    {% endif %}

  </div>
</div>

{% unless product == empty %}
  <script type="application/json" id="ProductJson-{{ section.id }}">
    {{ product | json }}
  </script>
{% endunless %}
</div>



{% schema %}
{
  "name": {
    "da": "Fremhævet produkt",
    "de": "Vorgestelltes Produkt",
    "en": "Featured product",
    "es": "Producto destacado",
    "fi": "Esittelyssä oleva tuote",
    "fr": "Produit vedette",
    "hi": "विशेष रुप से प्रदर्शित उत्पाद",
    "it": "Prodotto in primo piano",
    "ja": "おすすめ商品",
    "ko": "특별 상품",
    "nb": "Utvalgt produkt",
    "nl": "Uitgelicht product",
    "pt-BR": "Produto em destaque",
    "pt-PT": "Produto em destaque",
    "sv": "Utvald produkt",
    "th": "สินค้าที่แนะนำ",
    "zh-CN": "特色产品",
    "zh-TW": "精選產品"
  },
  "class": "product-template-section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Featured Product"
    },
    {
      "type": "product",
      "id": "featured_product",
      "label": {
        "da": "Produkt",
        "de": "Produkte",
        "en": "Product",
        "es": "Producto",
        "fi": "Tuote",
        "fr": "Produit",
        "hi": "उत्पाद",
        "it": "Prodotto",
        "ja": "商品",
        "ko": "제품",
        "nb": "Produkt",
        "nl": "Product",
        "pt-BR": "Produto",
        "pt-PT": "Produto",
        "sv": "Produkt",
        "th": "สินค้า",
        "zh-CN": "产品",
        "zh-TW": "產品"
      }
    },
    {
      "type": "checkbox",
      "id": "product_quantity_enable",
      "label": "Show quantity selector",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "product_sku_enable",
      "label": "Show product sku",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "product_upc_enable",
      "label": "Show product upc",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "product_quantity_message",
      "label": "Show in/out of stock message",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "house_hasson_catalog",
      "label": "Use House Hasson Inventory Tracker",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_clickable_boxes",
      "label": "Enable Clickable Box Option Selector",
      "default": false,
      "info": "Replace the dropdown with clickable boxes for product variant selection"
    },
    {
      "type": "checkbox",
      "id": "hide_variant_selector",
      "label": "Hide option selector",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "product_savings",
      "label": "Show Savings",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "hide_price",
      "label": "Hide price",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "hide_add_to_cart",
      "label": "Hide add to cart button",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_payment_button",
      "label": "Show Buy It Now Button",
      "info": "Each customer will see their preferred payment method from those available on your store, such as PayPal or Apple Pay. [Learn more](https://help.shopify.com/manual/using-themes/change-the-layout/dynamic-checkout)",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "social_sharing_products",
      "label": "Show social sharing buttons",
      "default": true,
      "info": "Edit social accounts in General settings"
    }
  ],
  "presets": [
    {
      "name": {
        "da": "Fremhævet produkt",
        "de": "Vorgestelltes Produkt",
        "en": "Featured product",
        "es": "Producto destacado",
        "fi": "Esittelyssä oleva tuote",
        "fr": "Produit vedette",
        "hi": "विशेष रुप से प्रदर्शित उत्पाद",
        "it": "Prodotto in primo piano",
        "ja": "おすすめ商品",
        "ko": "특별 상품",
        "nb": "Utvalgt produkt",
        "nl": "Uitgelicht product",
        "pt-BR": "Produto em destaque",
        "pt-PT": "Produto em destaque",
        "sv": "Utvald produkt",
        "th": "สินค้าที่แนะนำ",
        "zh-CN": "特色产品",
        "zh-TW": "精選產品"
      },
      "category": {
        "da": "Produkt",
        "de": "Produkte",
        "en": "Product",
        "es": "Producto",
        "fi": "Tuote",
        "fr": "Produit",
        "hi": "उत्पाद",
        "it": "Prodotto",
        "ja": "商品",
        "ko": "제품",
        "nb": "Produkt",
        "nl": "Product",
        "pt-BR": "Produto",
        "pt-PT": "Produto",
        "sv": "Produkt",
        "th": "สินค้า",
        "zh-CN": "产品",
        "zh-TW": "產品"
      }
    }
  ]
}
{% endschema %}
